var e=Object.assign;import{o as t,c as a,r as n,m as s,a as r,b as l,w as o,d as i,e as d,f as u,v as c,F as p,p as _,g as m,S as v,h,i as f,t as y,j as w,k as $,l as b,n as g,T as k,q as S}from"./vendor.a915a409.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(a){const n=new URL(e,location),s=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((a,r)=>{const l=new URL(e,n);if(self[t].moduleMap[l])return a(self[t].moduleMap[l]);const o=new Blob([`import * as m from '${l}';`,`${t}.moduleMap['${l}']=m;`],{type:"text/javascript"}),i=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(o),onerror(){r(new Error(`Failed to import: ${e}`)),s(i)},onload(){a(self[t].moduleMap[l]),s(i)}});document.head.appendChild(i)})),self[t].moduleMap={}}}("/random-wheel/assets/");var M={primary:"_primary_8hg3b_1",secondary:"_secondary_8hg3b_11",danger:"_danger_8hg3b_22",button:"_button_8hg3b_33",default:"_default_8hg3b_46",squared:"_squared_8hg3b_52"};const I={name:"Button",props:{appearance:{type:String,default:"primary",validator:e=>-1!==["primary","secondary","danger"].indexOf(e)},view:{type:String,default:"default",validator:e=>-1!==["default","squared"].indexOf(e)}}};(I.__cssModules={}).$style=M,I.render=function(e,r,l,o,i,d){return t(),a("button",s({class:[e.$style.button,e.$style[e.$props.appearance],e.$style[e.$props.view]]},e.$attrs),[n(e.$slots,"default")],16)};const x={name:"CloseIcon"},P={width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},B=r("path",{d:"M1 1L13 13",stroke:"currentColor"},null,-1),L=r("path",{d:"M13 1L1 13",stroke:"currentColor"},null,-1);x.render=function(e,n,s,r,l,o){return t(),a("svg",P,[B,L])};var W={backdrop:"_backdrop_1k1he_2",modal:"_modal_1k1he_14",closeButton:"_close-button_1k1he_24"};const j={name:"Modal",components:{CloseIcon:x}};(j.__cssModules={}).$style=W,j.render=function(e,s,i,d,u,c){const p=l("CloseIcon");return t(),a("div",{class:e.$style.backdrop,onClick:s[2]||(s[2]=o((t=>e.$emit("close-modal")),["self"]))},[r("div",{class:e.$style.modal},[r("div",{class:e.$style.closeButton,onClick:s[1]||(s[1]=t=>e.$emit("close-modal"))},[r(p)],2),n(e.$slots,"default")],2)],2)};var V={header:"_header_bohle_1",inner:"_inner_bohle_7"};const C={name:"Header",components:{Button:I}},q=d("Настройки");(C.__cssModules={}).$style=V,C.render=function(e,n,s,o,d,u){const c=l("Button");return t(),a("div",{class:e.$style.header},[r("div",{class:e.$style.inner},[r(c,{onClick:n[1]||(n[1]=t=>e.$emit("open-modal"))},{default:i((()=>[q])),_:1})],2)],2)};const A={name:"Link",props:{isExternalLink:{type:Boolean}},computed:{allProps(){const t={};return this.isExternalLink&&(t.target="_blank",t.rel="nofollow noopener noreferrer"),e(e({},this.$attrs),t)}}};(A.__cssModules={}).$style={},A.render=function(e,s,r,l,o,i){return t(),a("a",i.allProps,[n(e.$slots,"default")],16)};var D={footer:"_footer_wumne_1",inner:"_inner_wumne_7",icon:"_icon_wumne_13",linkWrapper:"_link-wrapper_wumne_25",mr:"_mr_wumne_30",ml:"_ml_wumne_35",link:"_link_wumne_25"};const O={name:"Footer",components:{Link:A}},T=r("img",{src:"https://avatars.githubusercontent.com/u/8355785",alt:"MissedWarrior"},null,-1);(O.__cssModules={}).$style=D,O.render=function(e,n,s,o,d,u){const c=l("Link");return t(),a("div",{class:e.$style.footer},[r("div",{class:e.$style.inner},[r("div",{class:e.$style.linkWrapper},[r("div",{class:e.$style.mr},"Made by",2),r(c,{"is-external-link":"",href:"https://github.com/missedwarrior",class:e.$style.link},{default:i((()=>[r("div",{class:e.$style.icon},[T],2),r("div",{class:e.$style.ml},"@MissedWarrior",2)])),_:1},8,["class"])],2)],2)],2)};const F=(e,t)=>{try{return e?JSON.parse(e):[]}catch(a){return(e=>{localStorage.removeItem(e)})(t),alert("Не удалось распознать сохранённые данные. Хранилище было очищено"),[]}};var U={input:"_input_1jd4o_1"};const E={name:"Input",props:["modelValue"],emits:["update:modelValue"],computed:{value:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}}}};(E.__cssModules={}).$style=U,E.render=function(e,n,r,l,o,i){return u((t(),a("input",s(e.$attrs,{type:e.$attrs.type,"onUpdate:modelValue":n[1]||(n[1]=e=>i.value=e),class:e.$style.input}),null,16,["type"])),[[c,i.value]])};var R={wrapper:"_wrapper_9oj7u_1",label:"_label_9oj7u_7",labelWrapper:"_label-wrapper_9oj7u_13",button:"_button_9oj7u_17",inputWrapper:"_input-wrapper_9oj7u_22"};const N={name:"AddPoint",components:{Button:I,Input:E},data:()=>({newPoint:""}),methods:{handleSubmit(){var e;(null==(e=this.newPoint)?void 0:e.length)>0&&(this.$emit("add-point",this.newPoint),this.newPoint="",this.$refs.input.$el.focus())}}},z=r("span",null,"Добавить новый пункт колеса:",-1),H=d("Добавить");(N.__cssModules={}).$style=R,N.render=function(e,n,s,d,u,c){const p=l("Input"),_=l("Button");return t(),a("form",{class:e.$style.wrapper,onSubmit:n[2]||(n[2]=o(((...e)=>c.handleSubmit&&c.handleSubmit(...e)),["prevent"]))},[r("div",{class:e.$style.labelWrapper},[r("label",{class:e.$style.label,for:"addPoint"},[z],2),r("div",{class:e.$style.inputWrapper},[r(p,{id:"addPoint",name:"addPoint",modelValue:u.newPoint,"onUpdate:modelValue":n[1]||(n[1]=e=>u.newPoint=e),modelModifiers:{trim:!0},autocomplete:"off",ref:"input"},null,8,["modelValue"])],2)],2),r("div",{class:e.$style.button},[r(_,null,{default:i((()=>[H])),_:1})],2)],34)};const J={name:"BackgroundImage"},G=r("div",null," BackgroundImage ",-1),K=r("div",null," Coming soon (c) ",-1);(J.__cssModules={}).$style={},J.render=function(e,n,s,r,l,o){return t(),a(p,null,[G,K],64)};var Q={label:"_label_5ifuj_1",input:"_input_5ifuj_5",primary:"_primary_5ifuj_9",secondary:"_secondary_5ifuj_19",button:"_button_5ifuj_30"};const X={name:"InputFile",props:{appearance:{type:String,default:"primary",validator:e=>-1!==["primary","secondary"].indexOf(e)}},methods:{uploadFile(e){this.$emit("upload",e)}}};(X.__cssModules={}).$style=Q,X.render=function(e,l,o,i,d,u){return t(),a("label",{class:e.$style.label},[r("input",s(e.$attrs,{class:e.$style.input,type:"file",onChange:l[1]||(l[1]=(...e)=>u.uploadFile&&u.uploadFile(...e))}),null,16),r("div",{class:[e.$style.button,e.$style[e.$props.appearance]]},[n(e.$slots,"default")],2)],2)};var Y={wrapper:"_wrapper_3wi47_1",importWrapper:"_import-wrapper_3wi47_7",exportWrapper:"_export-wrapper_3wi47_14"};const Z={name:"DataTransfer",components:{Button:I,InputFile:X},methods:{importData(e){this.$emit("import-data",e)},exportData(){this.$emit("export-data")}}},ee=r("div",null,[r("span",null,"Импортировать список")],-1),te=d("Импорт..."),ae=r("div",null,[r("span",null,"Экспортировать список")],-1),ne=d("Экспорт");(Z.__cssModules={}).$style=Y,Z.render=function(e,n,s,o,d,u){const c=l("InputFile"),p=l("Button");return t(),a("div",{class:e.$style.wrapper},[r("div",{class:e.$style.importWrapper},[ee,r("div",null,[r(c,{accept:"application/json",onUpload:u.importData},{default:i((()=>[te])),_:1},8,["onUpload"])])],2),r("div",{class:e.$style.exportWrapper},[ae,r("div",null,[r(p,{appearance:"secondary",onClick:u.exportData},{default:i((()=>[ne])),_:1},8,["onClick"])])],2)],2)};var se={wrapper:"_wrapper_1qfhu_1",break:"_break_1qfhu_11",keep:"_keep_1qfhu_16",hide:"_hide_1qfhu_20",left:"_left_1qfhu_26",center:"_center_1qfhu_30",right:"_right_1qfhu_34"};const re={name:"Point",props:{overflowStyle:{type:String,default:"keep",validator:e=>-1!==["keep","break","hide"].indexOf(e)},forceTitle:{type:Boolean,default:!1},title:{type:String},align:{type:String,default:"left",validator:e=>-1!==["left","center","right"].indexOf(e)}}};(re.__cssModules={}).$style=se,re.render=function(e,s,l,o,i,d){return t(),a("div",{class:[e.$style.wrapper,e.$style[l.align]],ref:"wrapper"},[r("div",{class:e.$style[l.overflowStyle],title:l.title,ref:"inner"},[n(e.$slots,"default")],10,["title"])],2)};const le={name:"simplebar-vue",data:()=>({instance:null}),mounted(){const e=v.getOptions(this.$attrs);this.instance=new v(this.$refs.element,e)},beforeUnmount(){var e;null==(e=this.instance)||e.unMount()},computed:{scrollElement(){return this.$refs.scrollElement},contentElement(){return this.$refs.contentElement}}},oe=h("data-v-62758100");_("data-v-62758100");const ie={class:"simplebar-wrapper"},de=r("div",{class:"simplebar-height-auto-observer-wrapper"},[r("div",{class:"simplebar-height-auto-observer"})],-1),ue={class:"simplebar-mask"},ce={class:"simplebar-offset"},pe={class:"simplebar-content-wrapper",ref:"scrollElement"},_e={class:"simplebar-content",ref:"contentElement"},me=r("div",{class:"simplebar-placeholder"},null,-1),ve=r("div",{class:"simplebar-track simplebar-horizontal"},[r("div",{class:"simplebar-scrollbar"})],-1),he=r("div",{class:"simplebar-track simplebar-vertical"},[r("div",{class:"simplebar-scrollbar"})],-1);m();const fe=oe(((e,l,o,i,d,u)=>(t(),a("div",s({ref:"element"},e.$attrs,{class:"wrapper"}),[r("div",ie,[de,r("div",ue,[r("div",ce,[r("div",pe,[r("div",_e,[n(e.$slots,"default")],512)],512)])]),me]),ve,he],16))));le.render=fe,le.__scopeId="data-v-62758100";var ye={svg:"_svg_4to29_1"};const we={name:"Trash"},$e=r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},null,-1);(we.__cssModules={}).$style=ye,we.render=function(e,n,r,l,o,i){return t(),a("svg",s({fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},e.$attrs,{class:e.$style.svg}),[$e],16)};var be={wrapper:"_wrapper_1ql28_1",inner:"_inner_1ql28_8",listItem:"_list-item_1ql28_12",iconWrapper:"_icon-wrapper_1ql28_21",button:"_button_1ql28_25",icon:"_icon_1ql28_21",point:"_point_1ql28_36"};const ge={name:"PointsList",components:{Trash:we,Button:I,Point:re,Simplebar:le},props:{list:{type:Array,required:!0}},methods:{removePoint(e){this.$emit("remove-point",e)}}};(ge.__cssModules={}).$style=be,ge.render=function(e,n,s,o,u,c){const _=l("Point"),m=l("Trash"),v=l("Button"),h=l("Simplebar");return t(),a("div",{class:e.$style.wrapper},[r(h,null,{default:i((()=>[r("div",{class:e.$style.inner},[(t(!0),a(p,null,f(s.list,(n=>(t(),a("div",{class:e.$style.listItem,key:n.id},[r("div",{class:e.$style.point},[r(_,{"overflow-style":"break"},{default:i((()=>[d(y(n.value),1)])),_:2},1024)],2),r("div",{class:e.$style.iconWrapper},[r(v,{appearance:"danger",view:"squared",class:e.$style.button,ref:"button",onClick:e=>c.removePoint(n.id)},{default:i((()=>[r("div",{class:e.$style.icon},[r(m)],2)])),_:2},1032,["class","onClick"])],2)],2)))),128))],2)])),_:1})],2)};var ke={wrapper:"_wrapper_12rpg_1",label:"_label_12rpg_6"};const Se={name:"SearchPoints",components:{Input:E},methods:{handleInput(e){const{value:t}=e.target;this.$emit("search",t)}}};(Se.__cssModules={}).$style=ke,Se.render=function(e,n,s,o,i,d){const u=l("Input");return t(),a("label",{class:e.$style.wrapper},[r("div",{class:e.$style.label},"Поиск по списку",2),r(u,{onInput:d.handleInput},null,8,["onInput"])],2)};var Me={addPoint:"_add-point_p01fr_1",searchPoints:"_search-points_p01fr_5",pointsList:"_points-list_p01fr_9",dataTransfer:"_data-transfer_p01fr_13"};const Ie={name:"Settings",components:{AddPoint:N,BackgroundImage:J,DataTransfer:Z,PointsList:ge,SearchPoints:Se},inject:["wheelStore"],data:()=>({searchValue:""}),computed:{resultList(){return this.searchValue.length>0?this.wheelStore.state.value.variants.filter((e=>e.value.includes(this.searchValue))):this.wheelStore.state.value.variants}},methods:{addPoint(e){this.wheelStore.addVariant(e)},removePoint(e){this.wheelStore.removeVariant(e)},handleSearch(e){this.searchValue=e},importData(e){const{files:t}=e.target,a=t[0];if(!a)return;if("application/json"!==a.type)return alert("Импортируемый файл должен быть с расширением .json");const n=new FileReader;n.readAsText(a),n.onload=()=>{let e;try{e=JSON.parse(n.result)}catch(a){return alert("Не удалось импортировать схему: данные повреждены.")}const t=(e=>{if(!e||"object"!=typeof e)return{isValid:!1,reason:"Некорректные входные данные"};if("v1"!==e.version)return{isValid:!1,reason:"Версия схемы не поддерживается"};if(Array.isArray(e.data))return e.data.every((e=>Boolean(e.value)))?{isValid:!0}:{isValid:!1,reason:"Сохранённый список повреждён"};return{isValid:!1,reason:"Произошла непредвиденная ошибка. Не удалось импортировать схему"}})(e);t.isValid||alert(t.reason),confirm("Внимание! В результате импорта ВСЕ текущие данные будут перезаписаны. Вы согласны?")&&(this.wheelStore.setNewVariants(e.data),alert("Данные успешно импортированы!"))},n.onerror=()=>{alert(`Не удалось считать файл по следующей причине: ${n.error}`)}},exportData(){const e=this.wheelStore.state.value.variants,t=(a=e,{version:"v1",saveDate:(new Date).toUTCString(),saveDateTimezone:"UTC",data:a});var a;const n=new Blob([JSON.stringify(t)],{type:"application/json"}),s=document.createElement("a");s.download="config-schema.json",s.href=URL.createObjectURL(n),s.click()}}};(Ie.__cssModules={}).$style=Me,Ie.render=function(e,n,s,o,i,d){const u=l("AddPoint"),c=l("SearchPoints"),_=l("PointsList"),m=l("DataTransfer"),v=l("BackgroundImage");return t(),a(p,null,[r("div",{class:e.$style.addPoint},[r(u,{onAddPoint:d.addPoint},null,8,["onAddPoint"])],2),r("div",{class:e.$style.searchPoints},[r(c,{onSearch:d.handleSearch},null,8,["onSearch"])],2),r("div",{class:e.$style.pointsList},[r(_,{list:d.resultList,onRemovePoint:d.removePoint},null,8,["list","onRemovePoint"])],2),r("div",{class:e.$style.dataTransfer},[r(m,{onImportData:d.importData,onExportData:d.exportData},null,8,["onImportData","onExportData"])],2),r("div",{class:e.$style.backgroundImage},[r(v)],2)],64)};var xe={wrapper:"_wrapper_1cy3a_1",winner:"_winner_1cy3a_8",winnerText:"_winner-text_1cy3a_18"};const Pe={name:"ButtonField",components:{Button:I},props:{rouletteList:{type:Array,required:!0},disabled:{type:Boolean,default:!1},winner:{type:String}}},Be=r("div",null,y("Победил вариант "),-1),Le=d(" Запустить рулетку! ");(Pe.__cssModules={}).$style=xe,Pe.render=function(e,n,s,o,d,u){const c=l("Button");return t(),a("div",{class:e.$style.wrapper},[s.winner?(t(),a("div",{key:0,class:e.$style.winner},[Be,r("div",{class:e.$style.winnerText},y(`"${s.winner}"!`),3)],2)):w("",!0),r("div",null,[r(c,{onClick:n[1]||(n[1]=t=>e.$emit("activate-wheel")),disabled:0===s.rouletteList.length||s.disabled},{default:i((()=>[Le])),_:1},8,["disabled"])])],2)};var We={wrapper:"_wrapper_1xsvn_1",wheelWrapper:"_wheel-wrapper_1xsvn_9",point:"_point_1xsvn_17",central:"_central_1xsvn_22",middle:"_middle_1xsvn_27",edge:"_edge_1xsvn_32"};const je=new Audio("/random-wheel/assets/lalahey.28dc8aad.mp3");je.volume=.07;const Ve=1e3*je.duration,Ce={name:"Wheel",components:{Point:re,ButtonField:Pe},inject:["wheelStore"],data:()=>({isWheelActive:!1,currentIndex:0,timerId:0,winner:null}),computed:{rouletteList(){const e=this.currentIndex,t=this.wheelStore.state.value.variants;if(t.length>0){const a=[];for(let n=0;n<5;n++){const s=t[(e+n)%t.length],r=this.assignClass(s,n);a.push(r)}return a}return[]}},methods:{activateWheel(){const e=this.wheelStore.state.value.variants;this.currentIndex=this.randomInteger(0,e.length-1),this.isWheelActive=!0,this.winner=null,je.play(),this.timerId=this.rotateWheel(),setTimeout((()=>{clearInterval(this.timerId),this.isWheelActive=!1,je.volume=.07,this.winner=this.rouletteList[Math.floor(2.5)].value}),Ve)},rotateWheel(){const e=this;let t=100;const{duration:a}=je,n=this.wheelStore.state.value.variants;return setTimeout((function s(){if(e.timerId=setTimeout(s,t),e.currentIndex<n.length-1)e.currentIndex+=1;else{if(e.currentIndex!==n.length-1)throw new Error("Array is out of bounds");e.currentIndex=0}const{currentTime:r}=je;r>.85*a?(je.volume=.04,t=400):r>.7*a?(je.volume=.06,t=200):t=100}),t)},assignClass(t,a){const n=e({},t);switch(a){case 0:case 4:n.class=this.$style.edge;break;case Math.floor(2.5):n.class=this.$style.central;break;default:n.class=this.$style.middle}return n},randomInteger(e,t){const a=e+Math.random()*(t+1-e);return Math.floor(a)}}},qe={key:1};(Ce.__cssModules={}).$style=We,Ce.render=function(e,n,s,o,u,c){const _=l("Point"),m=l("ButtonField");return t(),a("div",{class:e.$style.wrapper},[r("div",{class:e.$style.wheelWrapper},[c.rouletteList.length>0?(t(!0),a(p,{key:0},f(c.rouletteList,(n=>(t(),a("div",{class:e.$style.point},[r("div",{class:n.class},[r(_,{"overflow-style":"hide",title:n.value,"force-title":"",align:"center"},{default:i((()=>[d(y(n.value),1)])),_:2},1032,["title"])],2)],2)))),256)):(t(),a("div",qe," Список пуст "))],2),r(m,{disabled:u.isWheelActive,onActivateWheel:c.activateWheel,"roulette-list":c.rouletteList,winner:u.winner},null,8,["disabled","onActivateWheel","roulette-list","winner"])],2)};const Ae="roulette-data",De=()=>{return F((e=Ae,localStorage.getItem(e)),Ae);var e},Oe=$({variants:De()});b([Oe.value],(()=>{var e,t;e=Ae,t=JSON.stringify(Oe.value.variants),localStorage.setItem(e,t)}));var Te={app:"_app_p14z1_1",main:"_main_p14z1_7"};const Fe={name:"App",components:{Wheel:Ce,Modal:j,Footer:O,Header:C,Button:I,Settings:Ie},data:()=>({isModalOpen:!1}),provide:{wheelStore:{state:g(Oe),addVariant:e=>{const t={id:"_"+Date.now().toString(36).substr(2,9),value:e};Oe.value.variants.unshift(t)},regenerateStore:()=>{Oe.value={variants:De()}},setNewVariants:e=>{Oe.value.variants=e},removeVariant:e=>{const t=Oe.value.variants.findIndex((t=>t.id===e));Oe.value.variants.splice(t,1)}}},mounted(){console.log(`Built at ${new Date(1612827020839)}`)}};(Fe.__cssModules={}).$style=Te,Fe.render=function(e,n,s,o,d,u){const c=l("Header"),p=l("Wheel"),_=l("Footer"),m=l("Settings"),v=l("Modal");return t(),a("div",{class:e.$style.app},[r(c,{onOpenModal:n[1]||(n[1]=e=>d.isModalOpen=!0)}),r("div",{class:e.$style.main},[r(p)],2),r(_),(t(),a(k,{to:"body"},[d.isModalOpen?(t(),a(v,{key:0,onCloseModal:n[2]||(n[2]=e=>d.isModalOpen=!1)},{default:i((()=>[r(m)])),_:1})):w("",!0)]))],2)};S(Fe).mount("#app");
